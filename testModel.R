
# testModel Function accepts a trainedModel , malwareFile to test and appLogFile for negative test cases
testModel <- function(trainedModel.PHMM, testingMalwareLogFile, testingAppLogFile ){

  print(paste("Testing Model using files:",testingMalwareLogFile , " and ", testingAppLogFile ,sep=""))
  malware_test_data <- read.delim(testingMalwareLogFile)
  malware_testing<-list()
  for(i in 1:length(malware_test_data[[1]]))
    {
      malware_testing[[i]] <- toChar(malware_test_data[[1]][i])
    }

  probv <-c ()
  malwareLabels <-c ()
  print("Malware Testing starting")
  testSeqIndex = 1 
  for(i in 1:length(malware_testing)){
    x <- forward(trainedModel.PHMM, malware_testing[i], odds = TRUE)
    probv[testSeqIndex] <- x$score
    malwareLabels[testSeqIndex] <- 1
    testSeqIndex = testSeqIndex+1
  }
  print(paste("Malware Testing ended with total of ",testSeqIndex," malware logs.",seq=" "))
  #AppLog File
  app_test_data <- read.delim(testingAppLogFile)
  app_testing<-list()
  for(i in 1:length(app_test_data[[1]]))
  {
    app_testing[[i]] <- toChar(app_test_data[[1]][i])
  }
  print("App Testing starting.")
  
   for(i in 1:length(app_testing)){
    x <- forward(trainedModel.PHMM, app_testing[i], odds = TRUE)
    probv[testSeqIndex] <- x$score
    malwareLabels[testSeqIndex] <- 0
    testSeqIndex = testSeqIndex+1
   }
  
  print(paste("App Testing ended with total of ",length(app_testing), " app logs.",seq=" "))
  

  # notepad <- c("F","G","G","D","K","N","B","F","F","B","F","B","D","H","B","F","F","F","B","D","*","B","D","B","B","B","B","B","B","T","F","G","D","D","G","F","B","9","*","B","9","9","9","9","9","9","B","B","Y","D","F","E","9","G","*","*","*","*","B","G","*","B","*","*","*","*","*","*","B","9","B","B","B","B","E","*","E","*","9","*","*","B","*","*","B","B","2","M","B","G","B")
  # internetexplorer <- c("F","G","G","D","K","N","B","H","G","D","D","D","B","B","*","D","I","G","B","F","B","B","F","3","B","B","9","D","B","B","G","F","D","3","F","B","F","F","I","Y","D","T","F","H","B","B","B","B","B","B","*","*","H","F","D","G","*","H","3","F","Z","*","Q","4","*","U","B","*","G","B","H","H","D","E","B","J","J","J","F","I","N","U","H","E","F","F","9","B","Z","*","N","*","9","F","*","*","B","B","B","9","B","*","T","B","B","B","B","9","B","B","B","H","J","B","B","*","*","*","*","*","9","9","J","*","Y","D","B","G","*","*","*","*","E","*","L","D","B","J","J","N","N","*","B","*","3","*","*","F","G","G","D","K","N","B","H","G","D","D","B","B","B","*","G","*","D","I","B","D","F","B","F","I","B","9","D","F","B","F","F","B","B","B","B","F","B","B","B","B","*","B","B","B","9","9","D","U","F","D","H","H","D","G","B","N","F","*","T","F","4","D","*","F","*","F","B","B","8","*","*","*","9","9","9","9","9","*","*","B","3","B","F","G","G","D","K","N","F","B","H","B","U","Z","*","M","F","B","G","B","F","2","N","F","B","B","E","B","*","J","B","B","T","I","*","F","B","B","*","*","*","*","U","I","*","I","D","*","*","2","B","*","6","E","E","*","*","B","2","M","B")
  # 
  # x <- forward(trainedModel.PHMM, notepad, odds = TRUE)
  # probv[i] <- x$score
  # malwareLabels[i] <- 0
  # 
  # i = i+1
  # x <- forward(trainedModel.PHMM, internetexplorer, odds = TRUE)
  # probv[i] <- x$score
  # malwareLabels[i] <- 0

  print("Testing Completed!!!!!")
  result <- list("probv" = probv, "malwareLabels" =malwareLabels )

}

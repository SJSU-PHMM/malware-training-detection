#This is a script to create Model from MSA, train the Model and test it against malware family and app Logs.
# It finally gives the AUC score for the model trained.

library("aphid")
library("cvAUC")

#Update this malware family based if you want to execute PHMM for only one particular family of Malwares
source("properties.R")
source("phmmUtils.R")
source("loadMSAFromFile.R")
source("trainModel.R")

trainingFile <- paste("data/training/", "winwebsec_training.txt" , sep= "")


modelFileName <- paste("data/trainedModels/", malwareFamily , "_model.Rdata", sep="")
model <-  readRDS(file=modelFileName)

malware_trained.PHMM <- trainModel(model, trainingFile )

#Save Trained Model to file
print(paste("Saving trained model for family:",malwareFamily," to file ", modelFileName, sep=""))
saveRDS(malware_trained.PHMM, file=modelFileName)



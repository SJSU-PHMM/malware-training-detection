PHMM Based Malware Detection
======================
#### This Project Builds Model from MSA file , Trains PHMM Model, Tests the PHMM Model and gives AUC Score. ####

## Pre-requisites ##
### R ###
R is a free software environment for statistical computing and graphics.You can download R here: https://cran.r-project.org/mirrors.html


### aphid library ###
This Package is designed for the development and application of hidden Markov models and profile HMMs for biological sequence analysis.

https://www.rdocumentation.org/packages/aphid/versions/1.3.3

```
install.packages("aphid")
````

### cvAUC library ###

The cvAUC R package provides a computationally efficient means of estimating confidence intervals (or variance) of cross-validated Area Under the ROC Curve (AUC) estimates

https://www.r-project.org/nosvn/pandoc/cvAUC.html

```
install.packages("cvAUC")
```


## How to run the program ##
Ensure you have the above dependencies installed. 

### End To End Execute ###
To perform End to Execution right from loading MSA file, creating Model, training Model and getting AUC Score you can execute the following command from root directory of this project. 

```
source("endToEndExecute.R")
```

This picks up msa file from data/msa directory with appropriate malware family defined in endToEndExecute.R 

Currently there are msa, training and testing files available for consolidated (All malware family) and winwebsec family. 

```
malwareFamily = "consolidated"
```

### Test already Trained and saved model ###

```
source("testSavedModel.R")
```

## How to execute for a new virus family ##

There are 3 files mandatorily required to perform end to end execution of a new Virus family.

  1. MSA File ( *malwareFamily*_msa.txt in data/msa directory. MSA File is generated using project [seq-gen](https://github.com/SJSU-PHMM/seq-gen))
  2. Training File (*malwareFamily*_training.txt in data/training directory containing API sequences. One API sequence for each Virus in one line.)
  3. Testing File (*malwareFamily*_testing.txt in data/testing directory containing API sequences. One API sequence for each Virus in one line.)

Once these 3 files are uploaded into respective directory, then change the name of malwareFamily in endToEndExecute.R file and execute the file. This will generate a model from *malwareFamily*_msa.txt, train the model, save the trained model in data/trainedModels and then test the model using Testing file.  

## Acknowledgements ##

This software was developed at SJSU as part of Masters Project with guidance from our professor **Fabio Di Troia**. 

We are team of 5.

* Samod Shetty
* Joachim Lerman
* Jacob Jasser
* Monem Hamid
* Muhammad Ali

This repo is a part of the project. For complete project details along with links to other repos, please visit [Project Page](https://github.com/organizations/SJSU-PHMM).














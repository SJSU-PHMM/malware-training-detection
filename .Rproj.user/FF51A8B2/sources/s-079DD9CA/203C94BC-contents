#This is a script to test a trained Model and get AUC Score.

library("aphid")
library("cvAUC")

malwareFamily = "consolidated"

modelFileName <- paste("data/trainedModels/", malwareFamily , "_model.Rdata", sep="")

#malware API sequences to be tested
malwareTestSeqFileName <- paste("data/", malwareFamily,"_testing.txt" , sep= "")

#
appLogTestSeqFileName <- paste("data/", malwareFamily,"_testing.txt" , sep= "")

model <-  readRDS(file=modelFileName)

print(model)

results <- testModel(model , malwareTestSeqFileName,appLogTestSeqFileName )

aucValue <- AUC(results$probv, results$malwareLabels , label.ordering = NULL)

print(paste("AUC Score:",aucValue))
